<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test - Kolorowe Karty Statusów</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="hero-header">
        <div class="hero-content">
            <h1>Test - Kolorowe Karty Statusów</h1>
            <p>Test funkcjonalności kart filtrów statusów z licznikami</p>
        </div>
    </div>

    <main id="mainContent">
        <div id="applicationsCard">
            <!-- Kolorowe karty statusów -->
            <div id="quickFilters" style="margin: 1.5rem 0;">
                <div class="filter-cards-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                    <div class="filter-card status-card" data-filter-type="status" data-filter-value="" 
                         style="background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%); border: 2px solid #e2e8f0; padding: 1.25rem; border-radius: 12px; cursor: pointer; transition: all 0.3s ease; display: flex; flex-direction: column; align-items: center; text-align: center; min-height: 90px; justify-content: center;">
                        <i class="fas fa-list" style="font-size: 1.75rem; color: #64748b; margin-bottom: 0.5rem;"></i>
                        <span style="font-weight: 700; color: #334155; font-size: 1rem;">Wszystkie (<span id="totalCount">0</span>)</span>
                    </div>
                    
                    <div class="filter-card status-card" data-filter-type="status" data-filter-value="Wysłano CV" 
                         style="background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%); border: 2px solid #3b82f6; padding: 1.25rem; border-radius: 12px; cursor: pointer; transition: all 0.3s ease; display: flex; flex-direction: column; align-items: center; text-align: center; min-height: 90px; justify-content: center;">
                        <i class="fas fa-paper-plane" style="font-size: 1.75rem; color: #2563eb; margin-bottom: 0.5rem;"></i>
                        <span style="font-weight: 700; color: #1e40af; font-size: 1rem;">Wysłano CV (<span id="sentCount">0</span>)</span>
                    </div>
                    
                    <div class="filter-card status-card" data-filter-type="status" data-filter-value="Rozmowy" 
                         style="background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); border: 2px solid #f59e0b; padding: 1.25rem; border-radius: 12px; cursor: pointer; transition: all 0.3s ease; display: flex; flex-direction: column; align-items: center; text-align: center; min-height: 90px; justify-content: center;">
                        <i class="fas fa-comments" style="font-size: 1.75rem; color: #d97706; margin-bottom: 0.5rem;"></i>
                        <span style="font-weight: 700; color: #b45309; font-size: 1rem;">Rozmowy (<span id="interviewCount">0</span>)</span>
                    </div>
                    
                    <div class="filter-card status-card" data-filter-type="status" data-filter-value="Oferta" 
                         style="background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%); border: 2px solid #10b981; padding: 1.25rem; border-radius: 12px; cursor: pointer; transition: all 0.3s ease; display: flex; flex-direction: column; align-items: center; text-align: center; min-height: 90px; justify-content: center;">
                        <i class="fas fa-handshake" style="font-size: 1.75rem; color: #059669; margin-bottom: 0.5rem;"></i>
                        <span style="font-weight: 700; color: #047857; font-size: 1rem;">Oferta (<span id="offerCount">0</span>)</span>
                    </div>
                    
                    <div class="filter-card status-card" data-filter-type="status" data-filter-value="Odrzucono" 
                         style="background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%); border: 2px solid #ef4444; padding: 1.25rem; border-radius: 12px; cursor: pointer; transition: all 0.3s ease; display: flex; flex-direction: column; align-items: center; text-align: center; min-height: 90px; justify-content: center;">
                        <i class="fas fa-times-circle" style="font-size: 1.75rem; color: #dc2626; margin-bottom: 0.5rem;"></i>
                        <span style="font-weight: 700; color: #b91c1c; font-size: 1rem;">Odrzucono (<span id="rejectedCount">0</span>)</span>
                    </div>
                </div>
            </div>

            <!-- Test buttons -->
            <div style="text-align: center; margin: 2rem 0;">
                <button onclick="testCounters()" style="background: #3b82f6; color: white; border: none; padding: 10px 20px; border-radius: 8px; margin: 0 10px; cursor: pointer;">
                    Test Liczników
                </button>
                <button onclick="testActiveStates()" style="background: #10b981; color: white; border: none; padding: 10px 20px; border-radius: 8px; margin: 0 10px; cursor: pointer;">
                    Test Stanów Aktywnych
                </button>
                <button onclick="resetCards()" style="background: #6b7280; color: white; border: none; padding: 10px 20px; border-radius: 8px; margin: 0 10px; cursor: pointer;">
                    Reset
                </button>
            </div>

            <!-- Status info -->
            <div id="statusInfo" style="background: #f3f4f6; padding: 1rem; border-radius: 8px; margin: 1rem 0; text-align: center;">
                <p><strong>Status:</strong> Gotowy do testowania</p>
                <p id="activeCard">Aktywna karta: Brak</p>
            </div>
        </div>
    </main>

    <script>
        // Mock data for testing
        const mockApplications = [
            { status: 'Wysłano CV', archiwalna: false },
            { status: 'Wysłano CV', archiwalna: false },
            { status: 'Rozmowa telefoniczna', archiwalna: false },
            { status: 'Rozmowa online', archiwalna: false },
            { status: 'Oferta', archiwalna: false },
            { status: 'Odrzucono', archiwalna: false },
            { status: 'Odrzucono', archiwalna: false },
            { status: 'Wysłano CV', archiwalna: true }, // archived, should not count
        ];

        // Copy of the updateStatusCounters function from main.js
        function updateStatusCounters(applications = []) {
            const totalCountEl = document.getElementById('totalCount');
            const sentCountEl = document.getElementById('sentCount');
            const interviewCountEl = document.getElementById('interviewCount');
            const offerCountEl = document.getElementById('offerCount');
            const rejectedCountEl = document.getElementById('rejectedCount');

            if (!applications || applications.length === 0) {
                if (totalCountEl) totalCountEl.textContent = '0';
                if (sentCountEl) sentCountEl.textContent = '0';
                if (interviewCountEl) interviewCountEl.textContent = '0';
                if (offerCountEl) offerCountEl.textContent = '0';
                if (rejectedCountEl) rejectedCountEl.textContent = '0';
                return;
            }

            const activeApplications = applications.filter(app => !app.archiwalna);
            
            const totalCount = activeApplications.length;
            
            const sentCount = activeApplications.filter(app => 
                app.status && app.status.toLowerCase().includes('wysłano cv')
            ).length;
            
            const interviewCount = activeApplications.filter(app => {
                if (!app.status) return false;
                const interviewStatuses = ['Rozmowa telefoniczna', 'Rozmowa online', 'Rozmowa stacjonarna'];
                return interviewStatuses.includes(app.status);
            }).length;
            
            const offerCount = activeApplications.filter(app => 
                app.status && app.status.toLowerCase().includes('oferta')
            ).length;
            
            const rejectedCount = activeApplications.filter(app => 
                app.status && app.status.toLowerCase().includes('odrzucono')
            ).length;

            if (totalCountEl) totalCountEl.textContent = totalCount.toString();
            if (sentCountEl) sentCountEl.textContent = sentCount.toString();
            if (interviewCountEl) interviewCountEl.textContent = interviewCount.toString();
            if (offerCountEl) offerCountEl.textContent = offerCount.toString();
            if (rejectedCountEl) rejectedCountEl.textContent = rejectedCount.toString();
            
            console.log('Status counters updated:', {
                total: totalCount,
                sent: sentCount,
                interviews: interviewCount,
                offers: offerCount,
                rejected: rejectedCount
            });
        }

        // Test functions
        function testCounters() {
            updateStatusCounters(mockApplications);
            document.getElementById('statusInfo').innerHTML = `
                <p><strong>Status:</strong> Liczniki zaktualizowane!</p>
                <p>Total: 7, Wysłano CV: 2, Rozmowy: 2, Oferta: 1, Odrzucono: 2</p>
                <p>(1 archiwalna aplikacja nie została policzona)</p>
            `;
        }

        function testActiveStates() {
            // Remove active from all cards
            document.querySelectorAll('.filter-card').forEach(card => {
                card.classList.remove('active');
            });
            
            // Add active to "Rozmowy" card
            const rozmowy = document.querySelector('[data-filter-value="Rozmowy"]');
            if (rozmowy) {
                rozmowy.classList.add('active');
                document.getElementById('activeCard').textContent = 'Aktywna karta: Rozmowy';
            }
        }

        function resetCards() {
            document.querySelectorAll('.filter-card').forEach(card => {
                card.classList.remove('active');
            });
            
            // Activate "Wszystkie" card
            const allCard = document.querySelector('[data-filter-value=""]');
            if (allCard) {
                allCard.classList.add('active');
            }
            
            // Reset counters
            updateStatusCounters([]);
            
            document.getElementById('statusInfo').innerHTML = `
                <p><strong>Status:</strong> Reset zakończony</p>
                <p id="activeCard">Aktywna karta: Wszystkie</p>
            `;
        }

        // Initialize card click handlers
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('.filter-card[data-filter-type="status"]').forEach(card => {
                card.addEventListener('click', function() {
                    const filterValue = this.dataset.filterValue;
                    
                    // Remove active state from other status cards
                    document.querySelectorAll('.filter-card[data-filter-type="status"]').forEach(otherCard => {
                        otherCard.classList.remove('active');
                    });
                    
                    // Add active state to clicked card
                    this.classList.add('active');
                    
                    // Update status info
                    const cardName = filterValue === "" ? "Wszystkie" : filterValue;
                    document.getElementById('activeCard').textContent = `Aktywna karta: ${cardName}`;
                    
                    // Visual feedback
                    this.style.transform = 'scale(0.95)';
                    setTimeout(() => {
                        this.style.transform = '';
                    }, 150);
                });
            });
            
            // Initialize with "Wszystkie" active
            resetCards();
        });
    </script>
</body>
</html>
